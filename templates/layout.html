<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Journal</title>
    <link rel="stylesheet" href="{{css_path}}">
    <link rel="alternate" type="application/atom+xml" title="Journal Feed" href="/feed.xml">
    <script>
      (function() {
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
      })();
    </script>
    <script defer data-domain="journal.hal9.xyz" src="https://plsbl.hal9.xyz/js/script.js"></script>
</head>
<body>
    <div class="container">
        <header><a href="/">Journal</a></header>
        <nav>
            <ul>
                <li><a href="/all/">All</a></li>
                <li><a href="/recent/">Recent</a></li>
                <li><a href="#" onclick="goRandom(); return false;">Random</a></li>
                <li><a href="/about/">About</a></li>
                <li><a href="/feed.xml">RSS</a></li>
            </ul>
        </nav>
        <aside>
          <button class="theme-toggle" id="themeToggle" title="Toggle theme" aria-label="Toggle theme">
              <span id="themeIcon"></span>
          </button>
        </aside>
        <main>
            {{content}}
        </main>
        <nav>
          <ul>
            <li>üíæ <a href="/all/">All</a></li>
            <li>üé≤ <a href="#" onclick="goRandom(); return false;">Random</a></li>
          </ul>
        </nav>
        <footer>
            <p>(c) Manuel Gonz√°lez 2025. Journal: is not a blog.</p>
        </footer>
    </div>

    <script>
      async function goRandom() {
        try {
          const res = await fetch("/posts.json");
          if (!res.ok) return;
          const posts = await res.json();
          if (!posts.length) return;
          const randomIndex = Math.floor(Math.random() * posts.length);
          const post = posts[randomIndex];
          window.location.href = post.url;
        } catch (e) {
          console.error("Random navigation failed", e);
        }
      }

      // Theme Toggle Functionality
      (function() {
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        
        function updateIcon() {
          const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
          themeIcon.textContent = currentTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        }
        
        function toggleTheme() {
          const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
          const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
          
          document.documentElement.setAttribute('data-theme', newTheme);
          localStorage.setItem('theme', newTheme);
          updateIcon();
        }
      
        updateIcon();
        themeToggle.addEventListener('click', toggleTheme);
      })();
    </script>
</body>
</html>
